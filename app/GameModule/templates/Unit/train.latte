{block #scripts}
	{include #parent}
	<script type="text/javascript" src="{$basePath}/js/units.js"></script>
{/block}

{block #header}
	Trénink
{/block}

{block #content}
	<script>
		var totalSlots = {$totalSlots}
	</script>


	{form trainUnitForm}

		<!-- Jednoduché vykreslení chyb -->
		<ul class="errors" n:if="$form->hasErrors()">
				<li n:foreach="$form->errors as $error">{$error}</li>
		</ul>


		<table id="trainUnitTable">
			<tr>
				<th>Jméno</th>
				<td>Síla</td>
				{foreach $resources as $key => $res}
					<td>
						<img src="{$basePath}/images/resources/{$key}.png"/>
					</td>
				{/foreach}

				<td>Sloty</td>
				<td><img src="{$basePath}/images/icons/time.png"/></td>
				<td>Množství</td>
				<td>Max</td>
			</tr>

			{foreach $form->getControls() as $name => $field}
				{if $name !== 'send'}
					{?$cost}
					{?$tmpCost = $unitRules[$name]->getCost()}
					{foreach $resources as $key => $res}
						{?$cost[$key] = 0}
						{ifset $tmpCost[$key]}{?$cost[$key] = $tmpCost[$key]}{/ifset}
					{/foreach}

					<tr class="unit" data-costs="{$cost|json}" data-difficulty="{$unitRules[$name]->getDifficulty()|json}">
						<th class="name">
							{label $name /}
						</th>
						<td class="force">
							{$unitRules[$name]->getAttack()}/{$unitRules[$name]->getDefense()}
						</td>
						{foreach $resources as $key => $res}
							<td class="costs-{$key}">
								{$cost[$key]}
							</td>
						{/foreach}
						<td class="difficulty">
							{?$first = true}
							{foreach $unitRules[$name]->getDifficulty() as $key => $diff}
								{?$d = 0}
								{ifset $diff}{?$d = $diff}{/ifset}
								{if !$first}/{/if}
								<span class="{$key}">{$d}</span>
								{?$first = false}
							{/foreach}
						</td>
						<td class="trainingTime">
							{$trainingTimes[$name]}
						</td>
						<td class="amount">
							{input $name}
						</td>
						<td class="max"></td>
					</tr>
				{else}
					</table>
				{/if}
			{/foreach}


			<h2>Celkem</h2>
			{dump $slots}

			<h3>Volné sloty</h3>

			<table id="slotSum">
				<tr>
					<td>Slot</td>
					<td>Použito</td>
					<td>Zbývá</td>
					<td>Celkem</td>
				</tr>
				{foreach $slots as $key => $slot}
					<tr id="{$key}">
						<td>{$key}</td>
						<td class="used">0</td>
						<td class="remains">{$totalSlots[$key]}</td>
						<td>{$totalSlots[$key]}</td>
					</tr>
				{/foreach}
			</table>

			<h3>Suroviny</h3>
			<table id="resSum">
				<tr>
					{foreach $resources as $key => $res}
						<td>
							<img src="{$basePath}/images/resources/{$key}.png"/>
						</td>
					{/foreach}
				</tr>
				<tr>
					{foreach $resources as $key => $res}
						<td id="{$key}">0</td>
					{/foreach}
				</tr>
			</table>

			<table>
				<tr>
					<td></td><td></td><td></td><td colspan="5">{input $name}</td>
				</tr>
			</table>

	{/form trainUnitForm}



{/block}

