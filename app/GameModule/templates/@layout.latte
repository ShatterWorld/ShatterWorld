{**
 * ShatterWorld beta game-layout template.
 *
 * @copyright Copyright (c) 2010 Petr Bělohlávek
 * @package ShatterWorld
 *
 * @param string $basePath web base path
 * @param string $robots tell robots how to index the content of a page (optional)
 * @param array $flashes flash messages
 * @param array $content content
 *}
<!DOCTYPE html>
<html>
	<head>
		<title>{block #title}ShatterWorld{/block}</title>

		<meta name="keywords" content="shatter, world, nette, etc">
		<meta name="description" content="free online browser game">
		<meta name="author" content="Jan Buchar & Petr Bělohlávek">
		<meta name="robots" content="index, follow">

		<meta http-equiv="content-type" content="text/html;charset=UTF-8">
		<meta http-equiv="content-language" content="cs">

		<link rel="stylesheet" type="text/css" href="{$basePath}/css/game.css" />
		<link rel="stylesheet" type="text/css" href="{$basePath}/css/general.css" />
		<link rel="stylesheet" type="text/css" href="{$basePath}/css/flashes.css" />
		<link rel="stylesheet" type="text/css" href="{$basePath}/css/jquery-ui.css" />
		{block #scripts}
		<script type="text/javascript" src="{$basePath}/js/jquery_min.js"></script>
		<script type="text/javascript" src="{$basePath}/js/jquery-ui_min.js"></script>
		<script type="text/javascript" src="{$basePath}/js/jquery.nette.js"></script>
		<script type="text/javascript" src="{$basePath}/js/netteForms.js" ></script>
		<script type="text/javascript" src="{$basePath}/js/utils.js"></script>
		<script type="text/javascript" src="{$basePath}/js/tooltips.js"></script>
		<script type="text/javascript" src="{$basePath}/js/ui.js"></script>
		<script type="text/javascript" src="{$basePath}/js/cookie.js"></script>
		<script type="text/javascript" src="{$basePath}/js/descriptions.js"></script>
		<script type="text/javascript" src="{$basePath}/js/menu.js"></script>
		<script type="text/javascript" src="{$basePath}/js/flashes.js"></script>
		<script type="text/javascript" src="{$basePath}/js/switchClan.js"></script>
		<script type="text/javascript" src="{$basePath}/js/resources.js"></script>
		<script type="text/javascript" src="{$basePath}/js/orders.js"></script>
		<script type="text/javascript" src="{$basePath}/js/events.js"></script>
		{/block}

	</head>

	<body>
		{snippet flashes}
		{if $flashes}
			<div id="flashes">
				{foreach $flashes as $flash}
					<div class="flash {$flash->type}">
						{$flash->message}
					</div>
				{/foreach}
			</div>
		{/if}
		{/snippet}


		<div id="frame">

			<div id="banner">
				<div id="userBar">

					<div id="chooseClan" n:if="$presenter->getPlayerClan()">
						{form chooseClanForm}
							{input clan}
						{/form}
					</div>

					<a href="{link Profile:}" class="caption">{$user->identity->nickname}:</a>
					{if $user->isAllowed('administration')}
						<a href="{link :Admin:Dashboard:}">Administrace</a> |
					{/if}
					<a href="{link logout!}">Odhlásit se</a>
				</div>

				<div id="bannerMenu">
					<ul>
						<li><a href="">Nastavení</a> |</li>
						<li><a href="">Wiki</a> |</li>
						<li><a href="">Návod</a> |</li>
						<li><a href="">O projektu</a> |</li>
						<li><a href="">Přispějte</a> |</li>
						<li><a href="">Výhody</a> |</li>
						<li><a href="">Účet</li>
					</ul>
				</div>

			</div>

			<div id="infoBar">
				{snippet resources}
					<div id="resourceBar" data-resources="{$resources|json}">
						{foreach $resources as $resource => $data}
							<span class="text hasTooltip {$resource}" id="{$resource}">
								<img src="{$basePath}/images/resources/{$resource}.png" />
								<span class="text">
									<span class="balance{if $data['balance'] >= $data['storage']} resourceFull{/if}">{intval($data['balance'])}</span>/<span class="storage">{$data['storage']}</span>
								</span>
							</span>
							{?$rule = $resourceRules[$resource]}
							<div class="tooltip {$resource}" data-for="{$resource}">
								<h4>{$rule->getDescription()}</h4>
								<table>
									<tr><th>Zůstatek</th><td class="balance">{intval($data['balance'])}</td></tr>
									<tr><th>Kapacita skladu</th><td class="storage">{intval($data['storage'])}</td></tr>
									<tr><th>Produkce za hodinu</th><td class="production">{if $data['production'] > 0}+{/if}{intval($data['production'] * 3600)}</td></tr>
								</table>
							</div>
						{/foreach}
					</div>
				{/snippet}

				{snippet reports}
					<div id="reportBar" class="hasTooltip" n:if="$reportCount > 0">
						<span class="text">
							<img src="{$basePath}/images/icons/reports.png" />
							<a n:href="Report:" class="text">{$reportCount}</a>
						</span>
					</div>
					<div class="tooltip" data-for="reportBar">
						<table>
						<tr><th>Nepřečtená hlášení</th><td>{$reportCount}</td></tr>
						</table>
					</div>
				{/snippet}

				{snippet orders}
					<div id="orderBar" class="hasTooltip" data-nextorder="{$orderTimeout}">
						<span class="text"><img src="{$basePath}/images/icons/orders.png" />{$orderCount}/{$orderCap}</span>
					</div>
					<div class="tooltip" id="orderTooltip" data-for="orderBar">
						<table>
						<tr><th>Rozkazy k vydání</th><td>{$orderCount}</td></tr>
						<tr><th>Maximum rozkazů</th><td>{$orderCap}</td></tr>
						<tr><th>Další rozkaz</th><td class="countdown">{$orderTimeout|time}</td></tr>
						</table>
					</div>
				{/snippet}

				{snippet events}
					<div id="countdownBar" data-events="{$eventData|json}" class="hasTooltip">
						<img src="{$basePath}/images/icons/time.png" /><span class="text">{count($events)}</span>
					</div>
					<div id="countdownTooltip" class="tooltip" data-for="countdownBar">
						<table>
							<tr n:foreach="$events as $event" id="countdown_{$event->id}" class="data">
								<th>{$eventRules[$event->type]->getExplanation($event)}</th>
								<td class="countdown">{$event->getRemainingTime()|time}</td>
							</tr>
						</table>
					</div>
				{/snippet}

				<div class="clearer"><span></span></div>
			</div>


			<div id="menu">
				{if $user->isAllowed('administration')}
				<div class="submenu">
					<h3>Testing</h3>
					<ul>

						<li><a href="{link createUser!}">Generuj klan</a></li>
						<li><a href="{link create10Users!}">Generuj 10 klanů</a></li>
						<li><a href="{link create100Users!}">Generuj 100 klanů</a></li>
						<li><a href="{link :Admin:Dashboard:}">Administrace</a></li>

					</ul>
				</div>
				{/if}

				<div class="submenu{ifCurrent Dashboard:*} active{/ifCurrent}">
					<h3>Novinky</h3>

					<ul>
						<li><a href="{link Dashboard:}">Aktuality</a></li>
					</ul>
				</div>

				<div class="submenu{ifCurrent Clan:*} active{/ifCurrent}{ifCurrent Alliance:*} active{/ifCurrent}{ifCurrent Profile:*} active{/ifCurrent}">
					<h3>Klan</h3>
					<ul>
						{if !$presenter->getPlayerClan()}
							<li><a href="{link Clan:new}">Založit klan</a></li>
						{else}
							<li><a href="{link Clan:}">Přehled klanu</a></li>
							<li><a href="{link Clan:delete}">Smazat klan</a></li>
						{/if}

						<li>----------------</li>

						{if $presenter->getPlayerClan() && $presenter->getPlayerClan()->getAlliance()}
							<li><a n:href="Alliance:">Aliance</a></li>
							{if $presenter->isLeader()}
								<li><a n:href="Alliance:applicants">Přjmout členy</a></li>
								<li><a n:href="Alliance:management">Správa aliance</a></li>
							{/if}
							<li><a n:href="Alliance:leave">Opustit alianci</a></li>
							<li><a href="{link Score:alliance}">Skóre aliance</a></li>
						{else}
							<li><a n:href="Alliance:new">Nová aliance</a></li>
							<li><a n:href="Alliance:neutral">Přehled aliance</a></li>
						{/if}

						<li>----------------</li>

						{if !$presenter->getPlayerProfile()}
							<li><a href="{link Profile:new}">Založit profil</a></li>
						{else}
							<li><a href="{link Profile:}">Profil</a></li>
							<li><a href="{link Profile:edit}">Upravit profil</a></li>
							<li><a href="{link Profile:delete}">Smazat profil</a></li>
						{/if}

					</ul>

				</div>
				{if $presenter->getPlayerClan()}

					<div class="submenu{ifCurrent Map:*} active{/ifCurrent}">
						<h3>Mapa</h3>
						<ul class="tmp">
							<li><a href="{link Map:}">Podrobná</a></li>
							<li><a href="{link Map:minimised}">Minimalizovaná</a></li>
						</ul>
					</div>

					<div class="submenu{ifCurrent Unit:*} active{/ifCurrent}">
						<h3>Jednotky</h3>
						<ul class="tmp">
							<li><a href="{link Unit:}">Přehled</a></li>
							<li><a href="{link Unit:train}">Trénovat</a></li>
						</ul>
					</div>

					<div class="submenu{ifCurrent Market:*} active{/ifCurrent}">
						<h3>Tržnice</h3>

						<ul>
							<li><a href="{link Market:}">Přehled</a></li>
							<li><a href="{link Market:Buy}">Koupit</a></li>
							<li><a href="{link Market:Sell}">Prodat</a></li>
						</ul>
					</div>

					<div class="submenu{ifCurrent Research:*} active{/ifCurrent}">
						<h3>Výzkum</h3>

						<ul>
							<li><a href="{link Research:}">Přehled</a></li>
							<li><a href="{link Research:research}">Vyzkoumat</a></li>
						</ul>
					</div>

					<div class="submenu{ifCurrent Quest:*} active{/ifCurrent}{ifCurrent Score:*} active{/ifCurrent}">
						<h3>Úkoly</h3>

						<ul>
							<li><a href="{link Quest:}">Přehled</a></li>
						</ul>
					</div>

					<div class="submenu{ifCurrent Scoreboard:*} active{/ifCurrent}">
						<h3>Žebříčky</h3>

						<ul>
							<li><a href="{link Scoreboard:}">Klan</a></li>
							<li><a href="{link Scoreboard:alliance}">Aliance</a></li>
						</ul>
					</div>


					<div class="submenu{ifCurrent Message:*} active{/ifCurrent}">
						{?$msgCount = $presenter->getUnreadMsgCount()}
						<h3>Zprávy {if $msgCount > 0}<a href="{link Message:}">({$msgCount})</a>{/if}</h3>
						<ul>
							<li><a href="{link Message:new}">Napsat</a></li>
							<li><a href="{link Message:}">Přijaté</a></li>
							<li><a href="{link Message:sent}">Odeslané</a></li>
						</ul>
					</div>

				{/if}
			</div>

			<div id="container">
				<div id="header">{block #header}&nbsp;{/block}</div>
				<div id="content">
					{include #content}
				</div>
			</div>

			<div class="clearer"><span></span></div>

			<div id="footer">
				<a href='http://www.nette.org/cs/' target='_blank'><img src='{$basePath}/images/nette-powered1.gif' /></a>&nbsp;2011 &copy; Petr Bělohlávek & Jan Buchar

			</div>

		</div>


		<script>var basePath = {$basePath}</script>
	</body>

</html>
